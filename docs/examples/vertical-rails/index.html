<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Wizards of Lua by </title>
    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <link rel="stylesheet" href="/css/extra.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="/assets/js/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="/assets/css/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  </head>
  <body>
      
      <div id="header">
        <nav>
          <!-- <li class="fork"><a href="">View On GitHub</a></li> -->
          <li class="fork"><a href="https://github.com/wizards-of-lua/wizards-of-lua">View On GitHub</a></li>

          
            <li class="translate">
              <a href="http://translate.google.com/translate?hl=&sl=auto&tl=de&u=http%3A%2F%2Fwww.wizards-of-lua.net/examples/vertical-rails/" alt="Translate this page"></a>
            </li>
          
          <li class="discord"><a href="https://discord.gg/9En5Drt" alt="Discord"></a></li>
          <li class="twitter"><a href="https://twitter.com/WizardsOfLua?ref_src=twsrc%5Etfw" alt="Follow @WizardsOfLua"></a></li>
          
          
        </nav>
      </div><!-- end header -->
      
    <div class="wrapper">

      <section>
        <div id="title">
          <img src="/images/steven-with-magic-wand-glowing.png" height="170" />
          <h1><a href="/">Wizards of Lua</a></h1>
          <p>The Art of Spell Crafting</p>
          <hr>
          <!--
          <span class="credits left">Project maintained by <a href=""></a></span>
          <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></span>
          -->
        </div>

        <h1>The Vertical Rails Spell</h1>
        <p>Spells are really great to add new game experience.
For example, how nice would it be to have vertical rails
for minecarts?
<!--more--></p>

<p>Here is a short video that shows a spell that transforms ladders to vertical rails.</p>

<style>.embed-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; } .embed-container iframe, .embed-container object, .embed-container embed { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }</style>

<div class="embed-container"><iframe src="https://www.youtube.com/embed/VWeUUNAbcpU" frameborder="0" allowfullscreen=""></iframe></div>
<p><br /></p>

<p>Essentially the spell searches the world for all types of minecarts and checks if
they are close to a ladder.
If so, the minecart’s motion property is updated so that it moves upwards.</p>

<p>This spell must be inserted into a command block.
As always, don’t forget to add <tt>/lua </tt> in front of it.</p>
<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">/</span><span class="n">lua</span> <span class="n">speed</span><span class="o">=</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">;</span>
<span class="n">exitMotions</span> <span class="o">=</span> <span class="p">{</span>
  <span class="n">north</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">},</span>
  <span class="n">south</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">},</span>
  <span class="n">west</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
  <span class="n">east</span> <span class="o">=</span> <span class="p">{</span><span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">}</span>
<span class="p">};</span>
<span class="k">function</span> <span class="nf">addAll</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="k">in</span> <span class="nb">ipairs</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span> <span class="k">do</span>
    <span class="nb">table.insert</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
  <span class="k">end</span><span class="p">;</span>
<span class="k">end</span><span class="p">;</span>
<span class="k">while</span> <span class="kc">true</span> <span class="k">do</span>
  <span class="kd">local</span> <span class="n">minecarts</span> <span class="o">=</span> <span class="n">Entities</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'@e[type=minecart]'</span><span class="p">);</span>
  <span class="n">addAll</span><span class="p">(</span><span class="n">minecarts</span><span class="p">,</span> <span class="n">Entities</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'@e[type=chest_minecart]'</span><span class="p">));</span>
  <span class="n">addAll</span><span class="p">(</span><span class="n">minecarts</span><span class="p">,</span> <span class="n">Entities</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'@e[type=furnace_minecart]'</span><span class="p">));</span>
  <span class="n">addAll</span><span class="p">(</span><span class="n">minecarts</span><span class="p">,</span> <span class="n">Entities</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'@e[type=hopper_minecart]'</span><span class="p">));</span>
  <span class="n">addAll</span><span class="p">(</span><span class="n">minecarts</span><span class="p">,</span> <span class="n">Entities</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'@e[type=spawner_minecart]'</span><span class="p">));</span>
  <span class="n">addAll</span><span class="p">(</span><span class="n">minecarts</span><span class="p">,</span> <span class="n">Entities</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'@e[type=tnt_minecart]'</span><span class="p">));</span>

  <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">minecart</span> <span class="k">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">minecarts</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">spell</span><span class="p">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">minecart</span><span class="p">.</span><span class="n">pos</span><span class="p">;</span>
    <span class="k">if</span> <span class="n">spell</span><span class="p">.</span><span class="n">block</span><span class="p">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">'ladder'</span> <span class="k">then</span>
      <span class="kd">local</span> <span class="n">blockX</span> <span class="o">=</span> <span class="nb">math.floor</span><span class="p">(</span><span class="n">minecart</span><span class="p">.</span><span class="n">pos</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">;</span>
      <span class="kd">local</span> <span class="n">blockZ</span> <span class="o">=</span> <span class="nb">math.floor</span><span class="p">(</span><span class="n">minecart</span><span class="p">.</span><span class="n">pos</span><span class="p">.</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">;</span>
      <span class="kd">local</span> <span class="n">motion</span> <span class="o">=</span> <span class="p">{</span><span class="n">blockX</span> <span class="o">-</span> <span class="n">minecart</span><span class="p">.</span><span class="n">pos</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">speed</span><span class="p">,</span> <span class="n">blockZ</span> <span class="o">-</span> <span class="n">minecart</span><span class="p">.</span><span class="n">pos</span><span class="p">.</span><span class="n">z</span><span class="p">};</span>
      <span class="n">minecart</span><span class="p">:</span><span class="n">putNbt</span><span class="p">({</span><span class="n">Motion</span> <span class="o">=</span> <span class="n">motion</span><span class="p">});</span>
    <span class="k">else</span> <span class="cm">--[[ The else part just gives the minecart a little boost when exiting a ladder ]]</span>
      <span class="n">spell</span><span class="p">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">spell</span><span class="p">.</span><span class="n">pos</span> <span class="o">-</span> <span class="n">Vec3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
      <span class="k">if</span> <span class="n">spell</span><span class="p">.</span><span class="n">block</span><span class="p">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">'ladder'</span> <span class="k">then</span>
        <span class="kd">local</span> <span class="n">motion</span> <span class="o">=</span> <span class="n">exitMotions</span><span class="p">[</span><span class="n">spell</span><span class="p">.</span><span class="n">block</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">facing</span><span class="p">];</span>
        <span class="n">minecart</span><span class="p">:</span><span class="n">putNbt</span><span class="p">({</span><span class="n">Motion</span> <span class="o">=</span> <span class="n">motion</span><span class="p">});</span>
      <span class="k">end</span><span class="p">;</span>
    <span class="k">end</span><span class="p">;</span>
  <span class="k">end</span><span class="p">;</span>
  <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="k">end</span>
</code></pre></div></div>
<p>When activated this spell loops until you manually break it.</p>

<h2 id="credits">Credits</h2>
<p>This spell was created by Adrodoc55. Many thanks for that!</p>

<p>It was inspired by an amazing command block setup published by <em>Sparks</em> of <em>Gamemode 4</em>.</p>

<p>If you are curious, here is a video of it.</p>
<style>.embed-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; } .embed-container iframe, .embed-container object, .embed-container embed { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }</style>

<div class="embed-container"><iframe src="https://www.youtube.com/embed/LJoN7CmJL4Q" frameborder="0" allowfullscreen=""></iframe></div>
<p><br /></p>


        <div id="naviLeft">
<h2>Examples</h2>
<ul>

  <li>
    <a href="/examples/how-to-create-a-multicolor-floor-of-wool/">How to Create a Multicolored Floor of Wool</a>
  </li>

  <li>
    <a href="/examples/random-walk/">Random Walking Grass</a>
  </li>

  <li>
    <a href="/examples/the-army-of-zombies/">The Army of Zombies</a>
  </li>

  <li>
    <a href="/examples/the-door/">The Door</a>
  </li>

  <li>
    <a href="/examples/vertical-rails/">The Vertical Rails Spell</a>
  </li>

  <li>
    <a href="/examples/rocket-thrower/">The Rocket Thrower</a>
  </li>

<li><a href="/examples.html">See All Examples...</a></li>
</ul>
</div>


        <div id="naviRight">
<h2>Navigation</h2>
<ul>
   
      <li><a href="/" alt="Home">Home</a></li>
   
      <li><a href="/news" alt="News">News</a></li>
   
      <li><a href="/features" alt="Features">Features</a></li>
   
      <li><a href="/introduction" alt="Introduction">Introduction</a></li>
   
      <li><a href="/installation" alt="Download & Installation">Download & Installation</a></li>
   
      <li><a href="/configuration-file" alt="Configuration">Configuration</a></li>
   
      <li><a href="/lua-command" alt="The /lua Command">The /lua Command</a></li>
   
      <li><a href="/wol-command" alt="The /wol Command">The /wol Command</a></li>
   
      <li><a href="/spellbooklibrary" alt="Spell Book Library">Spell Book Library</a></li>
   
      <li><a href="/spellpacks.html" alt="Spell Packs">Spell Packs</a></li>
   
      <li><a href="/examples.html" alt="Examples">Examples</a></li>
   
      <li><a href="/tutorials.html" alt="Tutorials">Tutorials</a></li>
   
      <li><a href="/feedback" alt="Feedback">Feedback</a></li>
   
</ul>
</div>

      </section>

    </div>


    
  </body>
</html>
